
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Progress Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" />
</head>
<body class="bg-light">
    <div th:replace="fragments/navbar :: navbar"></div>
    <div class="container py-4">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="container py-4">
                    <h2 class="mb-4">Progress Dashboard</h2>
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="card mb-4">
                                <div class="card-header bg-primary text-white">
                                    <h5 class="mb-0">Weekly Mood Trend</h5>
                                </div>
                                <div class="card-body">
                                    <canvas id="dashboardMoodChart" height="100"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card mb-4">
                                <div class="card-header bg-info text-white">
                                    <h5 class="mb-0">Activity Distribution</h5>
                                </div>
                                <div class="card-body">
                                    <canvas id="activityChart" height="100"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mb-4">
                        <div class="col-md-12">
                            <div class="card mb-4">
                                <div class="card-header bg-success text-white">
                                    <h5 class="mb-0">Assessment History</h5>
                                </div>
                                <div class="card-body">
                                    <canvas id="assessmentChart" height="100"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mb-4">
                        <div class="col-md-4">
                            <div class="card text-center">
                                <div class="card-body">
                                    <h5 class="card-title">Achievements</h5>
                                    <ul class="list-group mb-3">
                                        <li class="list-group-item" th:each="ach : ${achievements}" th:text="${ach}"></li>
                                    </ul>
                                    <a href="/progress/student-progress" class="btn btn-success">See Details</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                <script th:inline="javascript">
                    /*<![CDATA[*/
                    var moodData = [[${dashboardMoodChartData}]];
                    var ctxMood = document.getElementById('dashboardMoodChart').getContext('2d');
                    var moodChart = new Chart(ctxMood, {
                        type: 'line',
                        data: {
                            labels: moodData.map(e => e.date),
                            datasets: [{
                                label: 'Mood',
                                data: moodData.map(e => e.moodValue),
                                backgroundColor: 'rgba(255, 206, 86, 0.2)',
                                borderColor: 'rgba(255, 206, 86, 1)',
                                borderWidth: 2,
                                tension: 0.3
                            }]
                        },
                        options: {
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        stepSize: 1,
                                        callback: function(value) {
                                            const moods = ['ðŸ˜¢', 'ðŸ˜', 'ðŸ˜Š', 'ðŸ˜¡', 'ðŸ¤©'];
                                            return moods[value] || value;
                                        }
                                    }
                                }
                            }
                        }
                    });

                    // Activity Distribution Chart (mock data)
                    var activityData = {
                        labels: ['Study', 'Exercise', 'Social', 'Rest', 'Other'],
                        datasets: [{
                            label: 'Activities',
                            data: [5, 3, 2, 4, 1],
                            backgroundColor: [
                                'rgba(54, 162, 235, 0.7)',
                                'rgba(255, 99, 132, 0.7)',
                                'rgba(255, 206, 86, 0.7)',
                                'rgba(75, 192, 192, 0.7)',
                                'rgba(153, 102, 255, 0.7)'
                            ]
                        }]
                    };
                    var ctxActivity = document.getElementById('activityChart').getContext('2d');
                    var activityChart = new Chart(ctxActivity, {
                        type: 'doughnut',
                        data: activityData
                    });

                    // Assessment History Chart (mock data)
                    var assessmentData = {
                        labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                        datasets: [{
                            label: 'Assessment Score',
                            data: [70, 80, 75, 90],
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 2,
                            tension: 0.3
                        }]
                    };
                    var ctxAssessment = document.getElementById('assessmentChart').getContext('2d');
                    var assessmentChart = new Chart(ctxAssessment, {
                        type: 'line',
                        data: assessmentData
                    });
                    /*]]>*/
                </script>
