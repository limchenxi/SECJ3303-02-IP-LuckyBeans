<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Self-Care Module - Innerly</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

</head>

</head>
<body>
    <div th:replace="fragments/navbar :: navbar"></div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Page Header -->
        <div class="page-header">
            <h1>Self-Care Module</h1>
            <p>Access Self-Care Modules | Track Progress | Receive Personalized Recommendations</p>
        </div>

        <!-- Personalized Recommendations -->
        <section class="recommendations-section" th:if="${recommendations != null and !recommendations.isEmpty()}">
            <div class="section-header">
                <span class="icon">‚ú®</span>
                <h2>Personalized Recommendations</h2>
            </div>
            <p class="section-subtitle">Based on your activity and mood</p>

            <div th:each="rec : ${recommendations}">
                <div class="recommendation-card">
                    <span class="ai-badge" th:if="${rec.isAI}" th:text="${rec.aiBadge}">AI</span>
                    
                    <div class="recommendation-header">
                        <div class="recommendation-icon" th:text="${rec.icon}">üìà</div>
                        <div class="recommendation-info">
                            <h3 th:text="${rec.title}">Progressive Muscle Relaxation</h3>
                            <p th:text="${rec.description}">Your recent stress levels suggest this practice could be beneficial</p>
                        </div>
                    </div>

                    <div class="recommendation-meta">
                        <span class="icon">‚äô</span>
                        <span th:text="${rec.basedOn}">Based on: Recent stress indicators, In-progress module</span>
                    </div>

                    <div class="recommendation-tags">
                        <span th:text="${rec.level}">Beginner</span>
                        <span th:text="${rec.duration} + ' min'">15 min</span>
                        <span class="progress-text" th:if="${rec.progress > 0}">
                            <span>üîÅ</span>
                            <span th:text="${rec.progress} + '% complete'">60% complete</span>
                        </span>
                    </div>

                    <a th:href="@{/self-care/module/{id}(id=${rec.moduleId})}" 
                       class="recommendation-btn" 
                       th:text="${rec.buttonText}">Continue Module</a>
                </div>
            </div>
        </section>

        <!-- Your Progress -->
        <section class="progress-section">
            <h2>Your Progress</h2>
            <p class="subtitle">Track your self-care journey</p>

            <div class="progress-stats">
                <div class="progress-left">
                    <div class="progress-percentage" th:text="${overallProgress.percentage} + '%'">48%</div>
                    <div class="progress-label">Overall Completion</div>
                </div>
                <div class="progress-right">
                    <div class="progress-modules" th:text="${overallProgress.completed} + '/' + ${overallProgress.total}">2/6</div>
                    <div class="progress-modules-label">Modules Completed</div>
                </div>
            </div>

            <div class="progress-bar-large">
                <div class="progress-fill-large" th:style="'width: ' + ${overallProgress.percentage} + '%'"></div>
            </div>
        </section>

        <!-- Category Tabs -->
        <div class="category-tabs">
            <a th:href="@{/self-care}" 
               class="category-tab" 
               th:classappend="${category == 'all'} ? 'active' : ''">All Modules</a>
            <a th:href="@{/self-care(category='mindfulness')}" 
               class="category-tab" 
               th:classappend="${category == 'mindfulness'} ? 'active' : ''">Mindfulness</a>
            <a th:href="@{/self-care(category='sleep')}" 
               class="category-tab" 
               th:classappend="${category == 'sleep'} ? 'active' : ''">Sleep</a>
            <a th:href="@{/self-care(category='journaling')}" 
               class="category-tab" 
               th:classappend="${category == 'journaling'} ? 'active' : ''">Journaling</a>
        </div>

        <!-- All Modules Grid -->
        <div class="modules-grid">
            <div class="module-card" th:each="module : ${allModules}" 
                 th:classappend="${module.isLocked} ? 'locked' : ''">
                
                <!-- Completed Status or Lock -->
                <div class="module-status" th:if="${module.completed and !module.isLocked}">
                    <span class="icon">‚úì</span>
                    <span>Completed</span>
                </div>

                <!--<div class="module-status" th:if="${module.isLocked}">-->
                <!--<span class="lock-icon">üîí</span>-->
                <!--</div>-->

                <div class="module-header">
                    <div class="module-icon" th:text="${module.icon}">üßò</div>
                    <div>
                        <h3 class="module-title" th:text="${module.title}">Mindful Breathing</h3>
                    </div>
                </div>

                <p class="module-description" th:text="${module.description}">
                    Learn to calm your mind through focused breathing exercises
                </p>

                <div class="module-meta">
                    <span class="meta-badge" th:text="${module.level}">Beginner</span>
                    <span class="meta-badge" th:text="${module.duration} + ' min'">10 min</span>
                </div>

                <div class="module-progress-section" th:if="${module.progress > 0 and !module.completed}">
                    <div class="module-progress-label">
                        <span>Progress</span>
                        <span th:text="${module.progress} + '%'">60%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" th:style="'width: ' + ${module.progress} + '%'"></div>
                    </div>
                </div>

                <a th:href="@{/self-care/module/{id}(id=${module.moduleId})}" 
                   class="module-btn">
                    Start Module
                </a>
            </div>
        </div>
    </main>
</body>
</html>

<!--th:classappend="${module.isLocked} ? 'locked' : ''"-->              
<!--th:text="${module.isLocked} ? 'üîí Locked' : (${module.completed} ? 'Review Module' : (${module.progress > 0} ? 'Continue' : 'Start Module'))"-->